<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8">
<title>Flipbook PDF.js + Turn.js</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.349/pdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.349/pdf.worker.min.js"></script>

<!-- jQuery + turn.js -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/turn.js/4.1.0/turn.min.js"></script>

<style>
body { margin:0; display:flex; flex-direction:column; align-items:center; background:#f3f4f6; font-family:sans-serif; }
#flipbook { width:900px; height:600px; margin:20px auto; }
#flipbook .page { width:450px; height:600px; background:white; position:relative; }
#flipbook .page canvas { width:100%; height:100%; object-fit:contain; display:block; }
.controls { margin:10px; display:flex; gap:10px; flex-wrap:wrap; justify-content:center; }
button { padding:6px 12px; border:none; background:#0ea5a4; color:white; border-radius:6px; cursor:pointer; }
button:disabled { opacity:.5; cursor:default; }
input[type=range]{ width:100px; }
</style>
</head>
<body>

<h2>Flipbook demo</h2>
<div id="flipbook"></div>

<div class="controls">
  <button id="prev">◀ Poprzednia</button>
  <button id="next">Następna ▶</button>
  <button id="fullscreen">Fullscreen</button>
  <label>Zoom:
    <input type="range" id="zoom" min="0.5" max="2" step="0.05" value="1">
  </label>
</div>

<script>
const pdfjsLib = window['pdfjs-dist/build/pdf'];
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.349/pdf.worker.min.js';
let pdfDoc = null;
let zoomScale = 1;

async function loadPdfFlipbook(url) {
  pdfDoc = await pdfjsLib.getDocument(url).promise;
  $("#flipbook").html("").turn("destroy");

  for (let i=1; i<=pdfDoc.numPages; i++) {
    const page = await pdfDoc.getPage(i);
    const viewport = page.getViewport({scale:1});
    const scale = 450 / viewport.width;
    const scaledViewport = page.getViewport({scale});
    const canvas = document.createElement("canvas");
    canvas.width = scaledViewport.width;
    canvas.height = scaledViewport.height;
    await page.render({canvasContext: canvas.getContext("2d"), viewport: scaledViewport}).promise;

    const pageDiv = document.createElement("div");
    pageDiv.className = "page";
    pageDiv.appendChild(canvas);
    $("#flipbook").append(pageDiv);
  }

  $("#flipbook").turn({
    width: 900,
    height: 600,
    autoCenter: true,
    display: 'double'
  });
}

// przewijanie
document.getElementById("prev").onclick = ()=>$("#flipbook").turn("previous");
document.getElementById("next").onclick = ()=>$("#flipbook").turn("next");

// fullscreen
document.getElementById("fullscreen").onclick = ()=>{
  const elem = document.getElementById("flipbook");
  if(elem.requestFullscreen) elem.requestFullscreen();
  else if(elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
  else if(elem.mozRequestFullScreen) elem.mozRequestFullScreen();
  else if(elem.msRequestFullscreen) elem.msRequestFullscreen();
};

// zoom
document.getElementById("zoom").addEventListener("input", e=>{
  zoomScale = parseFloat(e.target.value);
  $("#flipbook .page canvas").css("transform", `scale(${zoomScale})`);
  $("#flipbook .page").css("transform", `scale(${zoomScale})`);
});

// automatyczne wczytanie twoj_plik.pdf
loadPdfFlipbook("twoj_plik.pdf");
</script>
</body>
</html>
